2011-11-21  H.J. Lu  <hongjiu.lu@intel.com>

	* pthread_create.c (start_thread): Check __PTHREAD_MUTEX_HAVE_PREV
	instead of __WORDSIZE.

	* sysdeps/pthread/pthread.h (PTHREAD_MUTEX_INITIALIZER): Check
	__PTHREAD_MUTEX_HAVE_PREV instead of __WORDSIZE.
	(PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP): Likewise.
	(PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP): Likewise.
	(PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP): Likewise.
	(__PTHREAD_RWLOCK_INT_FLAGS_SHARED): New.
	(PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP): Check
	__PTHREAD_RWLOCK_INT_FLAGS_SHARED instead of __WORDSIZE.

	* sysdeps/unix/sysv/linux/x86_64/bits/pthreadtypes.h: Define x32
	__SIZEOF_PTHREAD_XXX_T.
	(__pthread_internal_list): Check __x86_64__ instead of __WORDSIZE.
	(pthread_mutex_t): Likewise.
	(pthread_rwlock_t): Likewise. 
	(__PTHREAD_RWLOCK_INT_FLAGS_SHARED): New.  Defined if __x86_64__
	is defined.

	* sysdeps/x86_64/tls.h: Don't include <bits/wordsize.h>.
	Check __x86_64__ instead of __WORDSIZE.
	(tcbhead_t): Pad rtld_savespace_sse to 32byte aligned.
	(THREAD_SETMEM): Use long long on 64bit integer.
	(THREAD_SETMEM_NC): Likewise.

	* sysdeps/x86_64/x32/tls.h: New.

2011-11-21  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/x86_64/pthreaddef.h (CURRENT_STACK_FRAME): Use
	RSP_LP.

2011-11-21  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/unix/sysv/linux/x86_64/lowlevellock.h (__NR_futex): New.
	(SYS_futex): Use it.
	(LLL_STUB_UNWIND_INFO_START): Align label to LP_SIZE instead
	of 8.
	(LLL_STUB_UNWIND_INFO_END): Likewise.  Use RDX_LP.

2011-11-21  H.J. Lu  <hongjiu.lu@intel.com>

	* unwind.c (unwind_stop): Cast _Unwind_GetCFA return to
	_Unwind_Ptr first.

2011-11-21  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/unix/sysv/linux/x86_64/cancellation.S: Use MOVE_LP
	and RDI_LP.

	* sysdeps/unix/sysv/linux/x86_64/pthread_cond_broadcast.S: Use
	RXX_LP and CMP_LP.
	* sysdeps/unix/sysv/linux/x86_64/pthread_cond_signal.S: Likewise.

	* sysdeps/unix/sysv/linux/x86_64/pthread_cond_timedwait.S: Use
	 RXX_LP and CMP_LP.  Use LP_SIZE and ASM_ADDR on
	 __gcc_personality_v0.
	* sysdeps/unix/sysv/linux/x86_64/pthread_cond_wait.S: Likewise.

	* sysdeps/unix/sysv/linux/x86_64/pthread_once.S: Use LP_SIZE
	and ASM_ADDR.

	* sysdeps/unix/sysv/linux/x86_64/sem_post.S: Use CMP_LP on
	NWAITERS.

	* sysdeps/unix/sysv/linux/x86_64/sem_timedwait.S: Use ADD_LP
	and SUB_LP on NWAITERS.  Use LP_SIZE and ASM_ADDR on
	__gcc_personality_v0.
	* sysdeps/unix/sysv/linux/x86_64/sem_wait.S: Likewise.
